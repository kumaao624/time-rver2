<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ãƒ“ãƒ–ãƒªã‚ªãƒãƒˆãƒ«ã‚¿ã‚¤ãƒãƒ¼</title>
<link href="https://fonts.googleapis.com/earlyaccess/keifont.css" rel="stylesheet">

<style>
:root{
  --bg:#fceff9;
  --card:#fff;
  --text:#222;
  --accent:#6fa8dc;
}
.dark{
  --bg:#1e1e2f;
  --card:#2b2b3c;
  --text:#eee;
  --accent:#8faadc;
}

body{
  margin:0;
  font-family:'Keifont',sans-serif;
  background:linear-gradient(135deg,var(--bg),#e8f3ff);
  color:var(--text);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.card{
  background:var(--card);
  width:95%;
  max-width:520px;
  padding:1.2em;
  border-radius:24px;
  box-shadow:0 12px 30px rgba(0,0,0,.15);
  text-align:center;
}

h1{margin:.2em 0;color:var(--accent);}

input,select{
  width:100%;
  padding:.6em;
  margin:.3em 0;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:1em;
}

.row{display:flex;gap:.5em;}

#timer{
  font-size:4em;
  font-weight:bold;
  margin:.3em 0;
}
.warning{
  color:#e06666;
  animation:pulse .8s infinite alternate;
}
@keyframes pulse{
  from{transform:scale(1)}
  to{transform:scale(1.05)}
}

#status{
  display:inline-block;
  padding:.3em 1em;
  border-radius:999px;
  margin-bottom:.5em;
  background:#eee;
}

button{
  padding:.7em;
  border:none;
  border-radius:14px;
  font-size:1em;
  margin:.2em;
  cursor:pointer;
}

#start{background:var(--accent);color:#fff;width:100%;}
#pause{background:#b7b7b7;color:#fff;}
#reset{background:#e06666;color:#fff;}
#qa{background:#93c47d;color:#fff;}
#settingsBtn{background:#c9daf8;}

#settings{
  display:none;
  margin-top:.6em;
  padding:.6em;
  background:#f4f6ff;
  border-radius:12px;
}

/* ===== æ¨ªå‘ã ===== */
@media (orientation: landscape){
  .card{
    max-width:90vw;
    display:grid;
    grid-template-columns:1.2fr 1fr;
    gap:1em;
  }
  h1{grid-column:span 2;}
  #timer{
    font-size:6em;
    grid-row:span 3;
    align-self:center;
  }
}
</style>
</head>

<body>
<div class="card">
<h1>ğŸ“˜ ãƒ“ãƒ–ãƒªã‚ªãƒãƒˆãƒ«</h1>

<input id="title" placeholder="æœ¬ã®ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆEnterã§ç¢ºå®šï¼‰">
<div id="titleView"></div>

<div class="row">
  <select id="pres">
    <option value="180">ãƒ—ãƒ¬ã‚¼ãƒ³ 3åˆ†</option>
    <option value="300" selected>ãƒ—ãƒ¬ã‚¼ãƒ³ 5åˆ†</option>
  </select>
  <select id="qaTime">
    <option value="120" selected>QA 2åˆ†</option>
    <option value="180">QA 3åˆ†</option>
  </select>
</div>

<div id="timer">05:00</div>
<div id="status">æº–å‚™ä¸­</div>

<button id="start">â–¶ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
<div>
  <button id="pause">â¸</button>
  <button id="reset">ğŸ”„</button>
</div>
<div>
  <button id="qa">ğŸ’¬ QAã¸</button>
  <button id="settingsBtn">âš™</button>
</div>

<div id="settings">
  éŸ³é‡
  <input type="range" id="volume" min="0" max="1" step="0.05" value="0.6">
  <br>
  <button id="dark">ğŸŒ™ ãƒ€ãƒ¼ã‚¯åˆ‡æ›¿</button>
</div>
</div>

<script>
let audioCtx;
let timer=null;
let time=0;
let paused=false;
let qa=false;
let started=false;
let volume=0.6;

const tDisp=timer=document.getElementById("timer");
const status=document.getElementById("status");

function ctx(){
  if(!audioCtx){
    audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  }
  audioCtx.resume();
}

function beep(f,d=.35,delay=0){
  ctx();
  const t=audioCtx.currentTime+delay;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.type="sine";
  o.frequency.value=f;
  g.gain.setValueAtTime(volume,t);
  g.gain.exponentialRampToValueAtTime(0.001,t+d);
  o.connect(g).connect(audioCtx.destination);
  o.start(t);o.stop(t+d);
}

function play(arr){arr.forEach((f,i)=>beep(f,.35,i*.4));}

function fmt(s){
  return String(Math.floor(s/60)).padStart(2,"0")+":"+String(s%60).padStart(2,"0");
}

function startTimer(){
  if(timer) return;
  timer=setInterval(()=>{
    if(paused) return;
    time--;
    tDisp.textContent=fmt(time);
    if(time===60) play([659,784]);
    if(time<=60) tDisp.classList.add("warning");
    if(time<=0){
      clearInterval(timer);timer=null;
      tDisp.classList.remove("warning");
      play([523,659,523]);
      if(!qa){
        qa=true;
        time=+qaTime.value;
        status.textContent="ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³";
        startTimer();
      }else{
        status.textContent="çµ‚äº†";
      }
    }
  },1000);
}

start.onclick=()=>{
  ctx();
  if(!started){
    play([523,659,784]);
    started=true;
    qa=false;
    time=+pres.value;
    tDisp.textContent=fmt(time);
    status.textContent="ãƒ—ãƒ¬ã‚¼ãƒ³ä¸­";
  }
  startTimer();
};

pause.onclick=()=>paused=!paused;
reset.onclick=()=>location.reload();

qa.onclick=()=>{
  if(started&&!qa){
    clearInterval(timer);timer=null;
    qa=true;
    time=+qaTime.value;
    status.textContent="ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³";
    play([784,659]);
    startTimer();
  }
};

settingsBtn.onclick=()=>{
  settings.style.display=settings.style.display==="block"?"none":"block";
};

volume.oninput=e=>volume=e.target.value;
dark.onclick=()=>document.body.classList.toggle("dark");

title.onkeydown=e=>{
  if(e.key==="Enter"&&title.value){
    titleView.textContent="ğŸ“– "+title.value;
    title.style.display="none";
  }
};

tDisp.textContent=fmt(+pres.value);
</script>
</body>
</html>
